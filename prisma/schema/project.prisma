model Project {
  id          String       @id @default(cuid())
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  name        String
  userId      String
  user        User         @relation(fields: [userId], references: [id])
  snapshot    Json? // tldraw document snapshot
  generations Generation[]

  @@index([userId])
}

model Generation {
  id           String           @id @default(cuid())
  createdAt    DateTime         @default(now())
  projectId    String
  project      Project          @relation(fields: [projectId], references: [id], onDelete: Cascade)
  prompt       String
  imageUrl     String? // Vercel Blob URL (null until completed)
  aspectRatio  String // e.g., "1:1", "16:9"
  width        Int
  height       Int
  status       GenerationStatus @default(PENDING)
  type         GenerationType   @default(FRAME)
  replicateId  String? // For polling status
  errorMessage String? // Error details when status is FAILED

  @@index([projectId])
}

enum GenerationStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum GenerationType {
  FRAME
  ASSET
}
